# 进程与线程的区别

进程是资源分配的最小单位；线程是CPU调度的最小单位。

一个线程只能属于一个进程，而一个进程可以有多个线程，但至少有一个线程。

一个线程崩溃，其对应的进程也会崩溃；一个进程崩溃，在保护模式下不会对其他进程产生影响。

进程创建与撤销的代价大于线程。

每个进程有独立的代码和数据空间，进程切换的代价较大，需要先切换页目录以使用新的地址空间，然后再切换硬件上下文和内核栈；而同一进程的各个线程共享代码和数据空间，线程切换只需要切换硬件上下文和内核栈即可。

> 硬件上下文：CPU 寄存器和程序计数器（Program Counter，PC）

# 协程是什么

协程是更加轻量级的线程，一个线程可以有多个协程。

协程是在用户态执行的，不受内核调度，完全是由程序所控制的。也因此，协程切换的开销比线程更小，上下文切换很快，执行效率非常高。

协程是在线程中运行的，所以不存在同时写变量的冲突，不需要多线程的锁机制，但是在协程内部操作共享资源且主动放弃执行权（await）的时候还是要加锁的[(注)](https://blog.csdn.net/zcxey2911/article/details/123573727)。

进程和线程都是同步机制，协程是异步机制。